# AI-Effect Sidecar Adapters for TEF Services
#
# These adapters expose the AI-Effect control interface and call the TEF service APIs.
# Run alongside the TEF services docker-compose.
#
# Usage:
#   docker compose up -d

services:
  knowledge-store-adapter:
    build:
      context: ..
      dockerfile: sidecar-adapters/knowledge_store/Dockerfile
    ports:
      - "18101:8080"
    environment:
      - KNOWLEDGE_STORE_URL=http://knowledge-store:8000
      - SELF_URL=http://knowledge-store-adapter:8080
    networks:
      - tef-network
    restart: unless-stopped

  synthetic-data-adapter:
    build:
      context: ..
      dockerfile: sidecar-adapters/synthetic_data/Dockerfile
    ports:
      - "18102:8080"
    environment:
      - SYNTHETIC_DATA_URL=http://synthetic-data:600
      - SELF_URL=http://synthetic-data-adapter:8080
    networks:
      - tef-network
    restart: unless-stopped

  data-provision-adapter:
    build:
      context: ..
      dockerfile: sidecar-adapters/data_provision/Dockerfile
    ports:
      - "18103:8080"
    environment:
      - DATA_PROVISION_URL=http://data-provision:600
      - SELF_URL=http://data-provision-adapter:8080
    volumes:
      - tef-data:/data:ro
    networks:
      - tef-network
    restart: unless-stopped

networks:
  tef-network:
    external: true
    name: tef-network

volumes:
  tef-data:
    external: true
    name: tef-synthetic-models
